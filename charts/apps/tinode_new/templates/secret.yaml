{{- if not .Values.openbao.enabled }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ include "tinode.fullname" . }}
  labels:
    {{- include "tinode.labels" . | nindent 4 }}
type: Opaque
stringData:
  # Encryption keys
  api-key-salt: {{ .Values.encryption.apiKeySalt | quote }}
  auth-token-key: {{ .Values.encryption.authTokenKey | quote }}
  uid-encryption-key: {{ .Values.encryption.uidEncryptionKey | quote }}
  
  # Database DSN
  {{- if eq .Values.database.type "postgres" }}
  postgres-dsn: {{ .Values.database.postgres.dsn | quote }}
  {{- else if eq .Values.database.type "mysql" }}
  mysql-dsn: {{ .Values.database.mysql.dsn | quote }}
  {{- end }}
  
  # SMTP password
  {{- if .Values.email.smtp.password }}
  smtp-password: {{ .Values.email.smtp.password | quote }}
  {{- end }}
  
  # S3 credentials
  {{- if and (eq .Values.media.handler "s3") .Values.media.s3.accessKeyId }}
  aws-access-key-id: {{ .Values.media.s3.accessKeyId | quote }}
  aws-secret-access-key: {{ .Values.media.s3.secretAccessKey | quote }}
  {{- end }}
  
  # TNPG auth token
  {{- if .Values.tnpg.enabled }}
  tnpg-auth-token: {{ .Values.tnpg.authToken | quote }}
  {{- end }}
{{- end }}